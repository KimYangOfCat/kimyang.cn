---
title: "å¯è§†åŒ– JavaScript å¼•æ“"
date: 2021-08-06
tags: [JavaScript]
categories: [ğŸŒ ç¿»è¯‘æ ¡å¯¹]
---

![](https://picbed.kimyang.cn/202109050840752.png)

ä½œä¸º JavaScript å¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬é€šå¸¸ä¸éœ€è¦äº²è‡ªä¸ç¼–è¯‘å™¨æ‰“äº¤é“ã€‚ä½†çŸ¥æ™“ JavaScript å¼•æ“çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠäº†è§£å®ƒæ˜¯å¦‚ä½•å¤„ç†æˆ‘ä»¬å„è‡ªä¸åŒçš„ JS ä»£ç å¹¶å°†å…¶è½¬åŒ–ä¸ºæœºå™¨èƒ½ç†è§£çš„ä¸œè¥¿ï¼Œä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼ğŸ¥³
<!-- more -->
> **æ³¨æ„ï¼š** è¿™ç¯‡æ–‡ç« ä¸»è¦åŸºäº Node.js å’Œä»¥ Chromium ä¸ºåŸºç¡€çš„æµè§ˆå™¨ä½¿ç”¨çš„ V8 å¼•æ“ã€‚

---

HTML è§£æå™¨åœ¨ä½ çš„ä»£ç ä¸­å¯»æ‰¾ `script` æ ‡ç­¾ä»¥åŠå…¶å¯¹åº”çš„æ¥æºï¼Œå¹¶ä»å…¶æ¥æºåŠ è½½ç¨‹åºæˆ–ä»£ç ã€‚å®ƒå¯èƒ½æ¥è‡ª **ç½‘ç»œ**ï¼Œ**ä¸´æ—¶å­˜å‚¨**ï¼Œæˆ–è€…å…¶å®ƒ**service worker**ã€‚ç„¶åä»¥**å­—èŠ‚æµ**çš„æ ¼å¼å“åº”ï¼Œç¨åè¯¥å­—èŠ‚æµå°†è¢«å­—èŠ‚æµè§£ç å™¨æ¥ç®¡ï¼ä¸»è¦æ˜¯**å­—èŠ‚æµè§£ç å™¨**ä¼šè§£ç åˆ°æ¥çš„æµæ•°æ®ã€‚

![](https://picbed.kimyang.cn/202109050840815.gif)

---

å­—èŠ‚æµè§£ç å™¨æ ¹æ®å·²è§£ç çš„çš„å­—èŠ‚æµåˆ›å»º tokenã€‚æ¯”å¦‚ï¼Œ`0066` è§£ç ä¸º `f`ï¼Œ`0075` å˜` u`ï¼Œ`006e` å˜ `n`ï¼Œ`0063` å˜ `c`ï¼Œ`0074` å˜ `t`ï¼Œ`0069` å˜ `i`ï¼Œ`006f` å˜ `o`ï¼Œ006e` å˜ä¸º `n` å’Œä¸€ä¸ªç©ºæ ¼ã€‚çœ‹ä¸Šå»å¥½åƒæ˜¯ä½ å†™äº† functionï¼è¿™åœ¨ JavaScript ä¸­æ˜¯ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼Œä¸€ä¸ª token è¢«åˆ›å»ºå¹¶å‘é€ç»™è§£æå™¨ï¼ˆä»¥åŠé¢„è§£æå™¨ï¼Œè¿™å¹¶æ²¡æœ‰æ¶µç›–åœ¨åŠ¨å›¾é‡Œä½†ç¨åä¼šè§£é‡Šï¼‰ã€‚å…¶ä½™å­—èŠ‚æµçš„å¤„ç†ä¹Ÿä¸€æ ·ã€‚

![](https://picbed.kimyang.cn/202109050841540.gif)

---

å¼•æ“ä½¿ç”¨ä¸¤ä¸ªè§£æå™¨ï¼šé¢„è§£æå™¨ï¼ˆpre-parserï¼‰å’Œè§£æå™¨ï¼ˆparserï¼‰ã€‚ä¸ºäº†å‡å°‘ç½‘ç«™åŠ è½½èŠ±è´¹çš„æ—¶é—´ï¼Œå¼•æ“ä¼šå°½é‡é¿å…å»è§£æä¸ä¼šè¢«ç«‹å³ä½¿ç”¨çš„ä»£ç ã€‚é¢„è§£æå™¨å¤„ç†å¯èƒ½ç¨åä¼šç”¨åˆ°çš„ä»£ç ï¼Œè€Œè§£æå™¨å¤„ç†é©¬ä¸Šéœ€è¦ä½¿ç”¨çš„ä»£ç ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°åªä¼šåœ¨ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åè¢«è°ƒç”¨ï¼Œé‚£ä¹ˆæ²¡æœ‰å¿…è¦ä¸€å®šè¦åœ¨ç½‘ç«™åŠ è½½æ—¶ç¼–è¯‘å®ƒã€‚å¦‚æœæœ€ç»ˆç”¨æˆ·ç‚¹å‡»äº†æŒ‰é’®ä¸”éœ€è¦è¿™æ®µä»£ç ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«å‘é€ç»™è§£æå™¨ã€‚

è§£æå™¨æ ¹æ®ä»å­—èŠ‚æµè§£ç å™¨å¤„æ¥æ”¶çš„ token æ¥åˆ›å»ºèŠ‚ç‚¹ï¼Œå¹¶ç”¨è¿™äº›èŠ‚ç‚¹æ¥åˆ›å»ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ã€‚ğŸŒ³

![](https://picbed.kimyang.cn/202109050841290.gif)

---

ä¸‹ä¸€æ­¥ï¼Œè§£é‡Šå™¨å‡ºåœºï¼è§£é‡Šå™¨éå† AST å¹¶æ ¹æ® AST æ‰€åŒ…å«çš„ä¿¡æ¯æ¥ç”Ÿæˆå­—èŠ‚ç ã€‚ä¸€æ—¦å­—èŠ‚ç ç”Ÿæˆå®Œæ¯•ï¼ŒAST å°±ä¼šè¢«åˆ é™¤ä»è€Œæ¸…ç©ºå†…å­˜ç©ºé—´ã€‚æœ€åï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†æœºå™¨å¯ä»¥ä½¿ç”¨çš„ä¸œè¥¿ã€‚ğŸ‰

![](https://picbed.kimyang.cn/202109050841747.gif)

---

å°½ç®¡å­—èŠ‚ç å¾ˆå¿«ï¼Œä½†å®ƒè¿˜å¯ä»¥æ›´å¿«ã€‚å­—èŠ‚ç è¿è¡Œæ—¶ä¼šç”Ÿæˆä¸€äº›ä¿¡æ¯ã€‚å®ƒå¯ä»¥æ£€æµ‹åˆ°æŸäº›è¡Œä¸ºæ˜¯å¦ç»å¸¸å‘ç”Ÿä»¥åŠè¢«ä½¿ç”¨çš„æ•°æ®ç±»å‹ã€‚å¯èƒ½æŸä¸ªå‡½æ•°ä½ è°ƒç”¨äº†å‡ åæ¬¡ï¼Œé‚£ä¹ˆæ˜¯æ—¶å€™åšä¼˜åŒ–äº†ï¼Œä½¿å…¶è¿è¡Œé€Ÿåº¦æ›´å¿«ã€‚ğŸƒğŸ½â€â™€ï¸

å­—èŠ‚ç ä»¥åŠäº§ç”Ÿçš„ç±»å‹åé¦ˆä¼šä¸€èµ·å‘é€ç»™ä¼˜åŒ–ç¼–è¯‘å™¨ã€‚ä¼˜åŒ–ç¼–è¯‘å™¨æ¥æ”¶å­—èŠ‚ç å’Œç±»å‹åé¦ˆï¼Œå¹¶ä»ä¸­ç”Ÿæˆé«˜åº¦ä¼˜åŒ–åçš„æœºå™¨ç ã€‚ğŸš€

![](https://picbed.kimyang.cn/202109050841326.gif)

---

JavaScript æ˜¯åŠ¨æ€ç±»å‹çš„è¯­è¨€ï¼Œè¿™ä»£è¡¨æ•°æ®ç±»å‹å¯ä»¥ä¸æ–­æ”¹å˜ã€‚å¦‚æœ JavaScript å¼•æ“æ¯æ¬¡éƒ½éœ€è¦æ£€æŸ¥æŸä¸ªå€¼çš„æ•°æ®ç±»å‹ï¼Œè¿™ä¼šå¯¼è‡´å…¶è¿è¡Œé€Ÿåº¦éå¸¸ç¼“æ…¢ã€‚

ä¸ºäº†å‡å°‘ä»£ç è§£é‡Šçš„æ—¶é—´ï¼Œä¼˜åŒ–åçš„æœºå™¨ç åªå¤„ç†å¼•æ“åœ¨è¿è¡Œå­—èŠ‚ç æ—¶ä¹‹å‰è§è¿‡çš„æƒ…å†µã€‚å¦‚æœæˆ‘ä»¬é‡å¤ä½¿ç”¨æŸæ®µä»£ç ï¼Œè¯¥ä»£ç ä¸€éåˆä¸€éçš„è¿”å›ç›¸åŒçš„æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆä¸ºäº†åŠ å¿«è¿è¡Œé€Ÿåº¦ï¼Œå°±å¯ä»¥ç®€å•çš„å†æ¬¡ä½¿ç”¨ä¼˜åŒ–åçš„æœºå™¨ç ã€‚ç„¶è€Œï¼ŒJavaScript æ˜¯åŠ¨æ€ç±»å‹ï¼Œç›¸åŒçš„ä»£ç å¯èƒ½ä¼šçªç„¶è¿”å›ä¸€ä¸ªä¸åŒçš„æ•°æ®ç±»å‹ã€‚å¦‚æœå‘ç”Ÿäº†è¿™ç§æƒ…å†µï¼Œæœºå™¨ç æ€§èƒ½ä¼šé€€åŒ–ï¼Œå¼•æ“ä¼šé€€å›åˆ°è§£é‡Šå·²äº§ç”Ÿçš„å­—èŠ‚ç çš„æ­¥éª¤ã€‚

å¦‚æœæŸå—ä»£ç è¢«è°ƒç”¨ 100 æ¬¡ï¼Œè€Œä¸”åˆ°ç›®å‰ä¸ºæ­¢è¿”å›ç›¸åŒçš„å€¼ã€‚é‚£ä¹ˆå¼•æ“ä¼šå‡è®¾ï¼Œå½“ä½ ç¬¬ 101 æ¬¡è°ƒç”¨çš„æ—¶å€™ä¾ç„¶è¿”å›è¯¥å€¼ã€‚

æ¯”å¦‚è¯´æˆ‘ä»¬æœ‰ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„æ±‚å’Œå‡½æ•°ï¼Œç›®å‰ä¸ºæ­¢è¯¥å‡½æ•°æ¯ä¸€æ¬¡è°ƒç”¨éƒ½ä¼šå¸¦æœ‰æ•°å­—ç±»å‹çš„å‚æ•°ã€‚

![](https://picbed.kimyang.cn/202109050841848.png)

è¯¥å‡½æ•°ä¼šè¿”å›æ•°å­— 3ï¼å½“æˆ‘ä»¬å†æ¬¡è°ƒç”¨æ—¶ï¼Œå¼•æ“ä¼šå‡å®šæˆ‘ä»¬ä¾ç„¶æºå¸¦ä¸¤ä¸ªæ•°å­—ç±»å‹çš„å‚æ•°ã€‚

å¦‚æœè¿™æ˜¯çœŸçš„ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦åŠ¨æ€æ£€æŸ¥ï¼Œå¼•æ“å¯ä»¥å†æ¬¡ä½¿ç”¨ä¼˜åŒ–åçš„æœºå™¨ç ã€‚åä¹‹ï¼Œå¦‚æœè¯¥å‡è®¾ä¸æ­£ç¡®ï¼Œé‚£ä¹ˆå¼•æ“ä¼šé€€å›åˆ°ä½¿ç”¨åŸæ¥çš„å­—èŠ‚ç è€Œä¸æ˜¯ä¼˜åŒ–çš„æœºå™¨ç ã€‚

æ¯”å¦‚ä¸‹ä¸€æ¬¡è°ƒç”¨å®ƒæ—¶æˆ‘ä»¬ä¼ é€’çš„æ˜¯å­—ç¬¦ä¸²è€Œä¸æ˜¯æ•°å­—ã€‚å› ä¸º JavaScript æ˜¯åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åšè€Œä¸”ä¸ä¼šå¼•å‘æŠ¥é”™ã€‚

![](https://picbed.kimyang.cn/202109050841566.png)

è¿™æ„å‘³ç€æ•°å­— `2` å°†ä¼šå¼ºåˆ¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œè€Œè¯¥å‡½æ•°å°†ä¼šè¿”å›å­—ç¬¦ä¸² `"12"`ã€‚å¼•æ“å°†å›é€€å»è§£é‡Šå­—èŠ‚ç ä»¥åŠæ›´æ–°ç±»å‹åé¦ˆã€‚

---

æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼ğŸ˜Š å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šæœ‰å…³å¼•æ“çš„çŸ¥è¯†ç‚¹åœ¨è¿™ç¯‡æ–‡ç« å†…æˆ‘æ²¡æœ‰ä»‹ç»ï¼ˆJS å †ï¼Œè°ƒç”¨æ ˆç­‰ç­‰ï¼‰ï¼Œè¿™äº›æˆ‘å¯èƒ½ç¨åä¼šæ¶µç›–ã€‚å¦‚æœä½ å¯¹ Javascript å†…éƒ¨è¿ä½œæ„Ÿå…´è¶£ï¼Œæˆ‘éå¸¸é¼“åŠ±å¼€å§‹è‡ªå·±åšä¸€äº›ç ”ç©¶ï¼ŒV8 æ˜¯å¼€æºçš„ï¼Œè€Œä¸”æœ‰ä¸€äº›å¾ˆæ£’çš„æ–‡æ¡£æ˜¯å…³äºå®ƒå¦‚ä½•åœ¨åå°å·¥ä½œçš„ã€‚ğŸ¤–

æ„Ÿè°¢é˜…è¯»ï¼Œç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©ï¼â¤

> * åŸæ–‡åœ°å€ï¼š[JavaScript Visualized: The JavaScript Engine](https://javascript.plainenglish.io/javascript-visualized-the-javascript-engine-1e3fc5d5310d)
> * åŸæ–‡ä½œè€…ï¼š[Harsh Patel](https://medium.com/@harsh-patel)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/article/2021/javascript-visualized-the-javascript-engine.md](https://github.com/xitu/gold-miner/blob/master/article/2021/javascript-visualized-the-javascript-engine.md)
> * è¯‘è€…ï¼š[æ²¡äº‹å„¿](https://github.com/Tong-H)
> * æ ¡å¯¹è€…ï¼š[Kim Yang](https://github.com/KimYangOfCat) [Usualminds](https://github.com/Usualminds)