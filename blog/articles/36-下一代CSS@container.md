---
title: "ä¸‹ä¸€ä»£ CSSï¼š@container"
date: 2021-07-09
tags: [CSS]
categories: [ğŸŒ ç¿»è¯‘æ ¡å¯¹]
---

Chrome æ­£åœ¨è¯•éªŒ CSS `@container` æŸ¥è¯¢å™¨åŠŸèƒ½ï¼Œè¿™æ˜¯ç”± [Oddbird](https://css.oddbird.net/rwd/query/) çš„ [Miriam Suzanne](https://twitter.com/TerribleMia) å’Œä¸€ç¾¤ç½‘ç»œå¹³å°å¼€å‘è€…æ”¯æŒçš„ CSS å·¥ä½œç»„ [Containment Level 3 è§„èŒƒ](https://github.com/w3c/csswg-drafts/issues?q=is%3Aissue+label%3Acss-contain-3+)ã€‚`@container` æŸ¥è¯¢å™¨ä½¿æˆ‘ä»¬èƒ½å¤Ÿ**æ ¹æ®çˆ¶å®¹å™¨çš„å¤§å°æ¥è®¾ç½®å…ƒç´ çš„æ ·å¼**ã€‚
<!-- more -->
> `@container` API ä¸ç¨³å®šï¼Œä¼šå—åˆ°è¯­æ³•å˜åŒ–çš„å½±å“ã€‚å¦‚æœä½ æƒ³è¦è‡ªå·±å°è¯•ä¸€ä¸‹ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›é”™è¯¯ã€‚è¯·å°†è¿™äº›é”™è¯¯æŠ¥å‘Šç»™ç›¸åº”çš„æµè§ˆå™¨å¼•æ“ï¼**æŠ¥å‘Šé”™è¯¯çš„é“¾æ¥å¦‚ä¸‹ï¼š**
>
> * [Chrome](https://bugs.chromium.org/p/chromium/issues/list)
> * [Firefox](https://bugzilla.mozilla.org/home)
> * [Safari](https://bugs.webkit.org/query.cgi?format=specific&product=WebKit)

ä½ å¯ä»¥æŠŠè¿™äº›æƒ³è±¡æˆä¸€ä¸ªåª’ä½“æŸ¥è¯¢ï¼ˆ`@media`ï¼‰ï¼Œä½†ä¸æ˜¯ä¾é  **viewport** æ¥è°ƒæ•´æ ·å¼ï¼Œè€Œæ˜¯ä½ çš„ç›®æ ‡å…ƒç´ çš„çˆ¶å®¹å™¨ä¼šè°ƒæ•´è¿™äº›æ ·å¼ã€‚

## å®¹å™¨æŸ¥è¯¢å°†æ˜¯è‡ª CSS3 ä»¥æ¥ Web æ ·å¼çš„æœ€å¤§å˜åŒ–ï¼Œå°†ä¼šæ”¹å˜æˆ‘ä»¬å¯¹â€œå“åº”å¼è®¾è®¡â€å«ä¹‰çš„çœ‹æ³•ã€‚

viewport å’Œç”¨æˆ·ä»£ç†ä¸å†æ˜¯æˆ‘ä»¬åˆ›å»ºå“åº”å¼å¸ƒå±€å’Œ UI æ ·å¼çš„å”¯ä¸€ç›®æ ‡ã€‚é€šè¿‡å®¹å™¨æŸ¥è¯¢ï¼Œå…ƒç´ å°†èƒ½å¤Ÿå®šä½è‡ªå·±çš„çˆ¶å…ƒç´ å¹¶ç›¸åº”åœ°åº”ç”¨è‡ªå·±çš„æ ·å¼ã€‚è¿™æ„å‘³ç€å­˜åœ¨äºä¾§è¾¹æ ã€ä¸»ä½“æˆ–å¤´å›¾ä¸­çš„ç›¸åŒå…ƒç´ å¯èƒ½ä¼šæ ¹æ®å…¶å¯ç”¨å¤§å°å’ŒåŠ¨æ€çœ‹èµ·æ¥å®Œå…¨ä¸åŒã€‚

## `@container` å®ä¾‹

åœ¨[æœ¬ç¤ºä¾‹](https://codepen.io/una/pen/LYbvKpK)ä¸­ï¼Œæˆ‘åœ¨çˆ¶çº§ä¸­ä½¿ç”¨äº†ä¸¤å¼ å¸¦æœ‰ä»¥ä¸‹æ ‡è®°çš„å¡ç‰‡ï¼š

```html
<div class="card-container">
    <div class="card">
        <figure> ...</figure>
        <div>
            <div class="meta">
                <h2>...</h2>
                <span class="time">...</span>
            </div>
            <div class="notes">
                <p class="desc">...</p>
                <div class="links">...</div>
            </div>
            <button>...</button>
        </div>
    </div>
</div>
```

ç„¶åï¼Œæˆ‘åœ¨å°†æŸ¥è¯¢å®¹å™¨æ ·å¼çš„çˆ¶çº§ï¼ˆ`.card-container`ï¼‰ä¸Šè®¾ç½® Containmentï¼ˆ[`contain` å±æ€§](https://css-tricks.com/almanac/properties/c/contain/)ï¼‰ã€‚æˆ‘è¿˜åœ¨ `.card-container` çš„çˆ¶çº§ä¸Šè®¾ç½®äº†ä¸€ä¸ªç›¸å¯¹ç½‘æ ¼å¸ƒå±€ï¼Œå› æ­¤å®ƒçš„ `inline-size` å°†æ ¹æ®è¯¥ç½‘æ ¼è€Œæ”¹å˜ã€‚è¿™å°±æ˜¯æˆ‘ä½¿ç”¨ `@container` æŸ¥è¯¢çš„å†…å®¹ï¼š

```css
.card-container {
  contain: layout inline-size;
  width: 100%;
}
```

ç°åœ¨ï¼Œæˆ‘å¯ä»¥æŸ¥è¯¢å®¹å™¨æ ·å¼æ¥è°ƒæ•´æ ·å¼ï¼è¿™ä¸ä½¿ç”¨åŸºäºå®½åº¦çš„åª’ä½“æŸ¥è¯¢è®¾ç½®æ ·å¼çš„æ–¹å¼éå¸¸ç›¸ä¼¼ï¼Œå½“å…ƒç´ **å°äºæŒ‡å®šå°ºå¯¸**æ—¶ä½¿ç”¨ `max-width` è®¾ç½®æ ·å¼ï¼Œå½“å…ƒç´ **å¤§äºæŒ‡å®šå°ºå¯¸**æ—¶ä½¿ç”¨ `min-width`ã€‚

```css
/* å½“çˆ¶å®¹å™¨å®½åº¦å°äº 850pxï¼Œ
ä¸å†æ˜¾ç¤º .links
å¹¶ä¸”å‡å° .time å­—ä½“å°ºå¯¸ */

@container (max-width: 850px) {
  .links {
    display: none;
  }

  .time {
    font-size: 1.25rem;
  }

  /* ... */
}

/* å½“çˆ¶å®¹å™¨å®½åº¦å°äº 650px æ—¶ï¼Œ
å‡å° .card å…ƒç´ ä¹‹é—´çš„ç½‘æ ¼é—´è·åˆ° 1rem */

@container (max-width: 650px) {
  .card {
    gap: 1rem;
  }

  /* ... */
}
```

![1](https://picbed.kimyang.cn/202109050840057.gif)

## å®¹å™¨æŸ¥è¯¢ + åª’ä½“æŸ¥è¯¢

å®¹å™¨æŸ¥è¯¢çš„æœ€ä½³åŠŸèƒ½ä¹‹ä¸€æ˜¯èƒ½å¤Ÿå°† **å¾®è§‚ä¸Šçš„å¸ƒå±€** ä¸ **å®è§‚ä¸Šçš„å¸ƒå±€** åˆ†å¼€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®¹å™¨æŸ¥è¯¢è®¾ç½®å•ä¸ªå…ƒç´ çš„æ ·å¼ï¼Œåˆ›å»ºç»†å¾®çš„å¾®è§‚å¸ƒå±€ï¼Œå¹¶ä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼ˆå®å¸ƒå±€ï¼‰è®¾ç½®æ•´ä¸ªé¡µé¢å¸ƒå±€çš„æ ·å¼ã€‚è¿™åˆ›é€ äº†ä¸€ä¸ªæ–°çš„æ§åˆ¶æ°´å¹³ï¼Œä½¿ç•Œé¢æ›´å…·å“åº”æ€§ã€‚

è¿™æ˜¯[å¦ä¸€ä¸ªç¤ºä¾‹](https://codepen.io/una/pen/RwodQZw)ã€‚å®ƒå±•ç¤ºäº†ä½¿ç”¨åª’ä½“æŸ¥è¯¢è¿›è¡Œå®è§‚å¸ƒå±€ï¼ˆå³æ—¥å†ä»å•é¢æ¿åˆ°å¤šé¢æ¿ï¼‰å’Œå¾®è§‚å¸ƒå±€ï¼ˆå³æ—¥æœŸå¸ƒå±€/å¤§å°å’Œäº‹ä»¶è¾¹è·/å¤§å°ç§»åŠ¨ï¼‰ï¼Œä»¥åˆ›å»ºä¸€ä¸ªæ¼‚äº®çš„å’Œè°çš„æŸ¥è¯¢ã€‚

![2](https://picbed.kimyang.cn/202109050840644.gif)

## å®¹å™¨æŸ¥è¯¢ + CSS ç½‘æ ¼

æˆ‘ä¸ªäººæœ€å–œæ¬¢çš„æŸ¥çœ‹å®¹å™¨æŸ¥è¯¢å½±å“çš„æ–¹æ³•ä¹‹ä¸€æ˜¯æŸ¥çœ‹å®ƒä»¬åœ¨ç½‘æ ¼ä¸­çš„å·¥ä½œæ–¹å¼ã€‚ä»¥ä¸‹é¢çš„æ¤ç‰©è´¸æ˜“ UI ä¸ºä¾‹ï¼š

![3](https://picbed.kimyang.cn/202109050840775.gif)

æœ¬ç½‘ç«™æ ¹æœ¬æ²¡æœ‰ä½¿ç”¨åª’ä½“æŸ¥è¯¢ã€‚ç›¸åï¼Œæˆ‘ä»¬åªä½¿ç”¨å®¹å™¨æŸ¥è¯¢å’Œ CSS ç½‘æ ¼æ¥åœ¨ä¸åŒçš„è§†å›¾ä¸­æ˜¾ç¤ºè´­ç‰©å¡ç»„ä»¶ã€‚

åœ¨äº§å“ç½‘æ ¼ä¸­ï¼Œå¸ƒå±€ä½¿ç”¨äº† `grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));` æ ‡è®°åˆ›å»ºã€‚è¿™å°†åˆ›å»ºä¸€ä¸ªå¸ƒå±€ï¼Œå‘Šè¯‰å¡ç‰‡å ç”¨å¯ç”¨çš„å°æ•°ç©ºé—´ï¼Œç›´åˆ°å®ƒä»¬çš„å¤§å°è¾¾åˆ° `230px`ï¼Œç„¶åä¸‹ä¸€æ ¼åˆ‡æ¢åˆ°ä¸‹ä¸€è¡Œã€‚ä½ å¯ä»¥åœ¨ [1linelayouts.com](http://1linelayouts.glitch.me) ä¸ŠæŸ¥çœ‹æ›´å¤šç½‘æ ¼æŠ€å·§ã€‚

ç„¶åï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå®¹å™¨æŸ¥è¯¢ï¼Œå½“å¡ç‰‡å®½åº¦å°äº `350px` æ—¶ï¼Œå®ƒä¼šå°†å¡ç‰‡æ ·å¼è®¾ç½®ä¸ºé‡‡ç”¨å‚ç›´å—å¸ƒå±€ï¼Œå¹¶é€šè¿‡åº”ç”¨ `display: flex`ï¼ˆé»˜è®¤æƒ…å†µä¸‹å…·æœ‰å†…è”æµï¼‰è½¬æ¢ä¸ºæ°´å¹³å†…è”å¸ƒå±€ã€‚

```css
@container (min-width: 350px) {
  .product-container {
    padding: 0.5rem 0 0;
    display: flex;
  }

  /* ... */
}
```

è¿™æ„å‘³ç€æ¯å¼ å¡ç‰‡**æ‹¥æœ‰è‡ªå·±çš„å“åº”å¼æ ·å¼**ã€‚è¿™æ˜¯æˆ‘ä»¬ä½¿ç”¨äº§å“ç½‘æ ¼åˆ›å»ºå®è§‚å¸ƒå±€ä»¥åŠä½¿ç”¨äº§å“å¡ç‰‡åˆ›å»ºå¾®è§‚å¸ƒå±€çš„å¦ä¸€ä¸ªç¤ºä¾‹ï¼Œé…·æ¯™äº†ï¼

## ç”¨æ³•

ä¸ºäº†ä½¿ç”¨`@container`ï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªå…·æœ‰ [Containment](https://developer.mozilla.org/zh-CN/docs/Web/CSS/contain) çš„çˆ¶å…ƒç´ ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨çˆ¶çº§ä¸Šè®¾ç½® `contain: layout inline-size`ã€‚å› ä¸ºæˆ‘ä»¬ç›®å‰åªèƒ½å°†å®¹å™¨æŸ¥è¯¢åº”ç”¨äºå†…è”è½´ï¼Œæ‰€ä»¥æˆ‘ä»¬åªå¯ä»¥ä½¿ç”¨ `inline-size`ã€‚è¿™ä¹Ÿå¯ä»¥é˜²æ­¢æˆ‘ä»¬çš„å¸ƒå±€åœ¨å—æ–¹å‘ä¸Šä¸­æ–­ã€‚

è®¾ç½® `contain: layout inline-size` ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ [Containment å—](https://developer.mozilla.org/zh-CN/docs/Web/CSS/Containing_block) å’Œæ–°çš„[å—æ ¼å¼ä¸Šä¸‹æ–‡](https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context)ï¼Œè®©æµè§ˆå™¨å°†å…¶ä¸å¸ƒå±€çš„å…¶ä½™éƒ¨åˆ†åˆ†å¼€ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å®¹å™¨æŸ¥è¯¢äº†ï¼

## é™åˆ¶

ç›®å‰ï¼Œæ‚¨ä¸èƒ½ä½¿ç”¨åŸºäºé«˜åº¦çš„å®¹å™¨æŸ¥è¯¢ï¼Œåªèƒ½ä½¿ç”¨å—è½´æ–¹å‘ä¸Šçš„æŸ¥è¯¢ã€‚ä¸ºäº†è®©ç½‘æ ¼å­å…ƒç´ ä¸ `@container` ä¸€èµ·å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªå®¹å™¨å…ƒç´ ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæ·»åŠ å®¹å™¨ä»å¯è®©æˆ‘ä»¬è·å¾—æ‰€éœ€çš„æ•ˆæœã€‚

## è¯•è¯•çœ‹

æ‚¨ç°åœ¨å¯ä»¥åœ¨ Chromium ä¸­è¯•éªŒ `@container` å±æ€§ï¼Œæ–¹æ³•æ˜¯å¯¼èˆªåˆ°ï¼š[Chrome Canary](https://www.google.com/chrome/canary/) ä¸­çš„ `chrome://flags` é¡µé¢å¹¶æ‰“å¼€ **#experimental-container-queries** æ ‡å¿—ã€‚

![](https://picbed.kimyang.cn/202109050840468.png)

---
 * åŸæ–‡åœ°å€ï¼š[Next Gen CSS: @container](https://css-tricks.com/next-gen-css-container/)
 * åŸæ–‡ä½œè€…ï¼š[Una Kravets](https://css-tricks.com/author/unakravets/)
 * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
 * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/article/2021/next-gen-css-containermd](https://github.com/xitu/gold-miner/blob/master/article/2021/next-gen-css-container.md)
 * è¯‘è€…ï¼š[éœœç¾½ Hoarfroster](https://github.com/PassionPenguin)
 * æ ¡å¯¹è€…ï¼š[Chorer](https://github.com/Chorer)ã€[Kim Yang](https://github.com/KimYangOfCat)