---
title: "TypeScript ä¸­çš„ä¾èµ–æ³¨å…¥"
date: 2021-05-24
tags: [TypeScript,å‰ç«¯]
categories: [ğŸŒ ç¿»è¯‘æ ¡å¯¹]
---

![](https://picbed.kimyang.cn/202109050832970.jpeg)
<!-- more -->

## ç®€ä»‹

æ¯ä¸€ä¸ªè½¯ä»¶ç¨‹åºéƒ½æœ‰å…¶æœ€åŸºç¡€çš„æ„å»ºæ¨¡å—ã€‚åœ¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œ æˆ‘ä»¬ä½¿ç”¨ç±»å»æ„å»ºå¤æ‚çš„ä½“ç³»æ¶æ„ã€‚åƒå»ºä¸€å¹¢å¤§æ¥¼ï¼Œæˆ‘ä»¬æŠŠæ¨¡å—ä¹‹é—´å»ºç«‹çš„è”ç³»ç§°ä¹‹ä¸º**ä¾èµ–**ã€‚å…¶ä»–çš„ç±»ä¸ºäº†æ”¯æŒæˆ‘ä»¬ç±»çš„éœ€æ±‚ï¼Œæä¾›å¤æ‚çš„å°è£…æ“ä½œã€‚

ä¸€ä¸ªç±»å¯èƒ½æœ‰å¼•ç”¨å…¶ä»–ç±»çš„å­—æ®µã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é—®åŠè¿™äº›é—®é¢˜ï¼šè¿™äº›å¼•ç”¨æ˜¯æ€ä¹ˆè¢«åˆ›å»ºçš„ï¼Ÿæ˜¯**æˆ‘ä»¬**å»ç»„åˆè¿™äº›å¯¹è±¡ï¼Œè¿˜æ˜¯**å…¶ä»–ç±»**è´Ÿè´£å®ä¾‹åŒ–å®ƒä»¬ï¼Ÿå¦‚æœè¦å®ä¾‹åŒ–çš„ç±»**å¤ªå¤æ‚**ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³é¿å…å‡ºç°åƒåœ¾ä»£ç ï¼Ÿæ‰€æœ‰è¿™äº›é—®é¢˜éƒ½å¯ä»¥è¯•å›¾é€šè¿‡**ä¾èµ–æ³¨å…¥åŸåˆ™**æ¥è§£å†³ã€‚

åœ¨å¼€å§‹ç¤ºä¾‹ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»è¦å»ç†è§£å…³äºä¾èµ–æ³¨å…¥çš„ä¸€äº›ç›¸å…³æ¦‚å¿µã€‚ä¾èµ–æ³¨å…¥åŸåˆ™å‘Šè¯‰æˆ‘ä»¬ï¼Œä¸€ä¸ªç±»åº”è¯¥å»**æ¥æ”¶**è€Œéå®ä¾‹åŒ–å®ƒçš„ä¾èµ–ã€‚é€šè¿‡å§”æ‰˜æ–¹å¼æ¥è¿›è¡Œå¯¹è±¡åˆå§‹åŒ–ï¼Œè¿™å¯ä»¥å¤„ç†è¾ƒä¸ºå¤æ‚çš„æ“ä½œï¼Œä»è€Œå‡å°‘åœ¨ç±»è®¾è®¡ä¸Šçš„å‹åŠ›ã€‚ä½ å¯ä»¥ç§»é™¤ä»£ç ä¸­å¤æ‚çš„æ¨¡å—ï¼Œå¹¶é€šè¿‡å…¶ä»–æ–¹å¼é‡æ–°å¼•å…¥ä¾èµ–ã€‚å¦‚ä½•å¤„ç†**ç§»é™¤**å’Œ**é‡æ–°å¼•å…¥ä¾èµ–**ï¼Œè¿™æ˜¯ä¾èµ–ç®¡ç†çš„é—®é¢˜ã€‚ä½ å¯ä»¥æ‰‹åŠ¨å¤„ç†æ‰€æœ‰å¯¹è±¡çš„åˆå§‹åŒ–å’Œæ³¨å…¥ï¼Œä½†æ˜¯è¿™å°†ä¼šä½¿æ•´ä¸ªç³»ç»Ÿå˜å¾—å¤æ‚ï¼Œæˆ‘ä»¬è¦å°½é‡é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚ç›¸åï¼Œä½ å¯ä»¥å°†æ„é€ çš„èŒè´£è½¬ç§»åˆ° **IoC å®¹å™¨**ã€‚

**æ§åˆ¶åè½¬**æ˜¯é€šè¿‡åè½¬æ•´ä¸ªç¨‹åºçš„æµç¨‹ï¼Œä»¥ä¾¿å®¹å™¨å¯¹æ‰€æœ‰ç¨‹åºä¸­æ¶‰åŠçš„ä¾èµ–è¿›è¡Œç®¡ç†ã€‚ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œæ•´ä¸ªå®¹å™¨è´Ÿè´£æ„é€ å¯¹è±¡ã€‚å½“ä¸€ä¸ªç±»éœ€è¦å®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼ŒIoC å®¹å™¨å¯ä»¥æä¾›å®ƒæ‰€éœ€è¦çš„ä¾èµ–ã€‚

IoC **åª**æä¾›äº†ä¸€ç§æ–¹æ³•è€Œéå…·ä½“çš„å®ç°ã€‚ä¸ºäº†ä½¿ç”¨ä¾èµ–æ³¨å…¥åŸåˆ™ï¼Œä½ éœ€è¦ä¸€ä¸ª**ä¾èµ–æ³¨å…¥æ¡†æ¶**ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š

* **Spring** å’Œ **Dagger**æ˜¯ **Java** çš„ä¾èµ–æ³¨å…¥æ¡†æ¶
* **Hilt** æ˜¯ **Kotlin** çš„ä¾èµ–æ³¨å…¥æ¡†æ¶
* **Unity** æ˜¯ **C#** çš„ä¾èµ–æ³¨å…¥æ¡†æ¶
* **Inversify**ã€**Nest.js** å’Œ **TypeDI** æ˜¯ **TypeScript** çš„ä¾èµ–æ³¨å…¥æ¡†æ¶

## æ¦‚è§ˆå’Œè§’è‰²åˆ’åˆ†

![ä¾èµ–æ³¨å…¥æ¦‚è§ˆ](https://picbed.kimyang.cn/202109050833517.png)

åœ¨ä¾èµ–æ³¨å…¥åŸåˆ™ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£**å››**ç§ä¸åŒçš„**è§’è‰²**:

* **å®¢æˆ·ç«¯**
* **æœåŠ¡ç«¯**
* **æ¥å£**
* **æ³¨å…¥å™¨**

**æœåŠ¡ç«¯**æ˜¯æˆ‘ä»¬å¯¹å¤–æš´éœ²æœåŠ¡ä½¿ç”¨çš„ã€‚è¿™äº›ç±»ç”± IoC å®¹å™¨å®ä¾‹åŒ–å’Œä½¿ç”¨ã€‚ä¸€ä¸ª**å®¢æˆ·ç«¯**é€šè¿‡ IoC å®¹å™¨æ¥ä½¿ç”¨è¿™äº›æœåŠ¡ã€‚å®¢æˆ·ç«¯ä¸åº”è¯¥è¢«å…·ä½“ç»†èŠ‚æ‰€å›°æ‰°ï¼Œå› æ­¤**æ¥å£**éœ€è¦ç¡®ä¿å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¿æŒåè°ƒã€‚å®¢æˆ·ç«¯è¯·æ±‚æ‰€éœ€çš„ä¾èµ–ï¼Œ**æ³¨å…¥å™¨**æä¾›å®ä¾‹åŒ–æœåŠ¡ã€‚

## ä¾èµ–æ³¨å…¥çš„ç±»å‹

å½“æˆ‘ä»¬è®¨è®ºå¦‚ä½•åœ¨ç±»ä¸­æ³¨å…¥ä¾èµ–æ—¶ï¼Œå¯ä»¥é€šè¿‡**ä¸‰ç§ä¸åŒæ–¹å¼**æ¥å®ç°ï¼š

* æˆ‘ä»¬å¯ä»¥é€šè¿‡**å±æ€§**(å­—æ®µ)æä¾›ä¾èµ–å…³ç³»ã€‚åœ¨ç±»ä¸Šå®šä¹‰å±æ€§ï¼Œç„¶åå°†å…·ä½“çš„å¯¹è±¡æ³¨å…¥åˆ°è¯¥å±æ€§ä¸­ï¼Œè¿™å°±æ˜¯å±æ€§æ³¨å…¥ã€‚é€šè¿‡å¯¹å¤–æš´éœ²è¿™ä¸ªå±æ€§ï¼Œä½†è¿™æ ·åš**è¿èƒŒ**äº†é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„**å°è£…**åŸåˆ™ï¼›å› æ­¤ï¼Œè¦å°½é‡é¿å…è¿™ç§æ³¨å…¥ã€‚
* æˆ‘ä»¬å¯ä»¥é€šè¿‡**æ–¹æ³•**æä¾›ä¾èµ–å…³ç³»ã€‚å¯¹è±¡çš„**çŠ¶æ€åº”è¯¥æ˜¯ç§æœ‰çš„**ï¼Œå½“å¤–éƒ¨æƒ³è¦æ”¹å˜è¯¥çŠ¶æ€æ—¶ï¼Œå®ƒåº”è¯¥è°ƒç”¨ç±»çš„ **getter/setter æ–¹æ³•**ã€‚æ‰€ä»¥å½“ä½ ä½¿ç”¨ setter æ–¹æ³•åˆå§‹åŒ–ç±»ä¸­çš„ç§æœ‰å­—æ®µæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨**æ–¹æ³•æ³¨å…¥**ã€‚
* æˆ‘ä»¬å¯ä»¥é€šè¿‡**æ„é€ å‡½æ•°**æä¾›ä¾èµ–å…³ç³»ã€‚æ„é€ å‡½æ•°æ–¹æ³•å› ä¸ºå…¶åŸºæœ¬å±æ€§å’Œå¯¹è±¡æ„é€ é«˜åº¦èåˆåœ¨ä¸€èµ·ã€‚æˆ‘ä»¬é€šå¸¸**æ”¯æŒé€šè¿‡æ„é€ å‡½æ•°**è¿›è¡Œæ³¨å…¥ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®æ ‡å’Œæ„é€ å‡½æ•°çš„æ–¹æ³•å¾ˆç±»ä¼¼ã€‚

## ä½¿ç”¨ TypeDI åº“

ä¸€æ—¦æˆ‘ä»¬ç†è§£äº†ä¾èµ–æ³¨å…¥çš„åŸºæœ¬åŸç†ï¼Œä½¿ç”¨ä»€ä¹ˆæ¡†æ¶æˆ–è€…åº“å·®åˆ«å¹¶ä¸å¤§ã€‚è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘é€‰æ‹©äº† TypeScript è¯­è¨€å’Œ TypeDI åº“æ¥å±•ç¤ºè¿™äº›åŸºæœ¬æ¦‚å¿µã€‚

åˆå§‹åŒ– Yarn å’Œæ·»åŠ  TypeScript ä¼šèŠ±ç‚¹æ—¶é—´ã€‚æˆ‘ä¸æƒ³ä½¿ç”¨æœ‰åæ°”ä½†æ²¡æœ‰è¶³å¤Ÿæ³¨é‡Šçš„é¡¹ç›®é…ç½®ï¼Œå› ä¸ºè¿™ä¼šè®©ä½ æ„Ÿåˆ°æ— è¶£ã€‚æ‰€ä»¥æˆ‘å°†ç»™å‡ºåˆæ­¥çš„ä»£ç å¹¶åšç®€è¦ä»‹ç»ã€‚ä½ å¯ä»¥ä»[è¿™ä¸ª Github ä»“åº“](https://github.com/mertturkmenoglu/typescript-dependency-injection)æŸ¥çœ‹å’Œä¸‹è½½ä»£ç ã€‚

ä»»ä½• TypeScript é¡¹ç›®éƒ½å¯ä»¥ä½œä¸ºä¾èµ–æ³¨å…¥æ¼”ç¤ºçš„ä¾‹å­ã€‚ä½†è¿™ç¯‡æ–‡ç« é‡Œæˆ‘é€‰æ‹©äº†ä¸€ä¸ª Node/Express åº”ç”¨ä½œä¸ºç¤ºä¾‹ã€‚æˆ‘å‡è®¾ä½¿ç”¨ TypeScript çš„å¼€å‘è€…è¦ä¹ˆç›´æ¥ä½¿ç”¨ Node/Express æœåŠ¡å™¨ï¼Œè¦ä¹ˆå¯¹å®ƒä»¬æœ‰æ‰€äº†è§£ã€‚

å½“ä½ æŸ¥çœ‹ `package.json` æ–‡ä»¶æ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ°è¿™äº›ä¾èµ–é¡¹é…ç½®ï¼Œè®©æˆ‘ç®€è¦ä»‹ç»ä¸‹å®ƒä»¬ï¼š

* **express**ï¼šExpress æ˜¯ç¼–å†™ Node.js RESTful æœåŠ¡çš„æµè¡Œæ¡†æ¶ã€‚
* **reflect-metadata**ï¼šä¸€ä¸ªç”¨äºå…ƒæ•°æ®åå°„ API çš„åº“ã€‚å®ƒå…è®¸å…¶ä»–åº“é€šè¿‡è£…é¥°å™¨ä½¿ç”¨å…ƒæ•°æ®ã€‚
* **ts-node**ï¼šNode.js æ— æ³•è¿è¡Œ TypeScript æ–‡ä»¶ã€‚åœ¨ä»£ç è¿è¡Œå‰ï¼Œéœ€è¦å°† TypeScript ç¼–è¯‘ä¸º JavaScriptã€‚ts-node å¸®ä½ å¤„ç†äº†è¿™ä¸ªè¿‡ç¨‹ã€‚
* **typedi**ï¼šTypeDI æ˜¯ä¸€ä¸ª TypeScript ä¾èµ–æ³¨å…¥åº“ã€‚æˆ‘ä»¬å¾ˆå¿«ä¼šçœ‹åˆ°å®ƒçš„ç¤ºä¾‹ã€‚
* **typescript**ï¼šæˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨äº† TypeScriptï¼Œå› æ­¤éœ€è¦å°†å®ƒä¹Ÿä½œä¸ºä¸€ä¸ªä¾èµ–ã€‚
* **@types/express**ï¼šExpress åº“çš„ç±»å‹å®šä¹‰ã€‚
* **@types/node**ï¼šNode.js çš„ç±»å‹å®šä¹‰ã€‚
* **ts-node-dev**ï¼šè¿™ä¸ªåº“å…è®¸ä½ è¿è¡Œ TypeScriptï¼Œå¹¶è§‚å¯ŸæŸäº›æ–‡ä»¶çš„å˜åŒ–æƒ…å†µã€‚

ä½ éœ€è¦ç•™æ„ä¸€äº›é‡è¦çš„ç¼–è¯‘å™¨é€‰é¡¹é…ç½®ã€‚å¦‚æœä½ çœ‹ä¸‹ **tsconfig.json**ï¼Œä½ å¯ä»¥çœ‹åˆ°ç¼–è¯‘è¿‡ç¨‹çš„é…ç½®é€‰é¡¹ï¼š

* æˆ‘ä»¬ä¸º **reflect-metadata** å’Œ **node** æŒ‡å®šäº†ç±»å‹ã€‚
* æˆ‘ä»¬å¿…é¡»å°† **mitDecoratorMetadata** å’Œ **experimentalDecorators** è®¾ç½®ä¸º trueã€‚

æ‰€æœ‰çš„æºç éƒ½åœ¨ **src** æ–‡ä»¶å¤¹ä¸‹ã€‚**src/index.ts** æ˜¯æˆ‘ä»¬é¡¹ç›®çš„å…¥å£æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶åŒ…å«äº†æœåŠ¡å™¨çš„æ‰€æœ‰å¼•å¯¼æ­¥éª¤ï¼š

```TypeScript
import 'reflect-metadata';

import express from 'express';
import Container from 'typedi';
import UserController from './controllers/UserController';

const main = async () => {
  const app = express();

  const userController = Container.get(UserController);

  app.get('/users', (req, res) => userController.getAllUsers(req, res));

  app.listen(3000, () => {
    console.log('Server started');
  });
}

main().catch(err => {
  console.error(err);
});
```

è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªåªæœ‰ä¸€ä¸ªç«¯å£çš„å°å‹ Express æœåŠ¡å™¨ã€‚å½“ä½ å‘ **/users** è·¯ç”±å‘é€ä¸€ä¸ª **GET** è¯·æ±‚æ—¶ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ã€‚**main** å‡½æ•°çš„æ ¸å¿ƒæ˜¯ **Container.get** æ–¹æ³•ã€‚æ³¨æ„æˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨ new å…³é”®å­—æˆ–è€…å®ä¾‹åŒ–å¯¹è±¡ã€‚æˆ‘ä»¬åªæ˜¯è°ƒç”¨ IoC å®¹å™¨è¿”å›çš„ä¸€ä¸ª UserController å®ä¾‹æ–¹æ³•ã€‚ç„¶åç»‘å®šäº†è·¯ç”±å’Œæ§åˆ¶å™¨æ–¹æ³•ã€‚

æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ RESTful æœåŠ¡å™¨ï¼Œä½†æˆ‘ä¸æƒ³è®©å®ƒæ²¡æœ‰ä¸€ç‚¹æ„ä¹‰ã€‚æˆ‘æ·»åŠ äº†å››ä¸ªä¸åŒçš„æ–‡ä»¶å¤¹ä»£è¡¨ä¸€ä¸ªå®Œå¤‡åç«¯æœåŠ¡çš„åŸºæœ¬éƒ¨åˆ†ã€‚å®ƒä»¬æ˜¯ **controllers**ã€**models**ã€**repositories** å’Œ **services**ã€‚ç°åœ¨è®©æˆ‘ä¸€ä¸ªä¸ªä»‹ç»ä¸‹å®ƒä»¬ï¼š

* **Controllers** æ–‡ä»¶å¤¹åŒ…å«æˆ‘ä»¬çš„ **REST æ§åˆ¶å™¨**ã€‚å®ƒä»¬è´Ÿè´£åè°ƒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡ã€‚å®ƒä»¬æ¥æ”¶è¯·æ±‚å¹¶è¿”å›å“åº”ã€‚
* **Models** æ–‡ä»¶å¤¹åŒ…å«æˆ‘ä»¬çš„**æ•°æ®åº“å®ä½“ç±»**ã€‚æˆ‘ä»¬æ²¡æœ‰æ•°æ®åº“è¿æ¥ï¼Œä¹Ÿä¸éœ€è¦ï¼Œä½†å»ºç«‹ä¸€ä¸ªåˆé€‚çš„é¡¹ç›®ç»“æ„å¯¹äºå­¦ä¹ è¯¥é¡¹ç›®æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚æˆ‘ä»¬å‡è®¾å®ƒæ˜¯çœŸæ˜¯çš„æ•°æ®åº“å®ä½“å¹¶ç»§ç»­æˆ‘ä»¬çš„é¡¹ç›®ã€‚
* **Services** æ–‡ä»¶å¤¹åŒ…å«æˆ‘ä»¬çš„**æœåŠ¡**ã€‚å®ƒä»¬é€šè¿‡è®¿é—®ä¸åŒçš„å­˜å‚¨åº“ï¼Œè´Ÿè´£ä¸º REST æ§åˆ¶å™¨æä¾›æ‰€éœ€æœåŠ¡ã€‚
* **Repositories** æ–‡ä»¶å¤¹åŒ…å«æˆ‘ä»¬**æ•°æ®åº“è¿æ¥ç±»**ã€‚æˆ‘ä»¬ä½¿ç”¨ Data Mapper æ¨¡å¼æ¥æ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚è¯¥æ¨¡å¼ä¸­æˆ‘ä»¬ä½¿ç”¨å®ä½“ç±»æ¥è®¿é—®æ•°æ®åº“å¹¶è¿›è¡Œç›¸å…³æ“ä½œã€‚

æˆ‘ä»¬ä¸ä¼šæŠŠæ‰€æœ‰çš„ä¸œè¥¿éƒ½æ”¾åˆ°ä¸€ä¸ªç±»ä¸­ã€‚è¯·æ±‚å’Œå“åº”ä¹‹é—´è¿˜æœ‰å¾ˆå¤šå±‚çº§ã€‚è¿™å°±æ˜¯æ‰€è°“çš„**åˆ†å±‚æ¶æ„**ã€‚é€šè¿‡ç±»ä¹‹é—´çš„ä¾èµ–å…±äº«ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å®¹æ˜“åœ°è¿›è¡Œä¾èµ–æ³¨å…¥ã€‚

```TypeScript
import { Request, Response } from "express";
import { Service } from "typedi";
import UserService from "../services/UserService";

@Service()
class UserController {
  constructor(private readonly userService: UserService) { }
  async getAllUsers(_req: Request, res: Response) {
    const result = await this.userService.getAllUsers();
    return res.json(result);
  }
}

export default UserController;
```

UserController åªæœ‰ä¸€ä¸ªæ–¹æ³•ã€‚`getAllUsers` æ–¹æ³•è´Ÿè´£ä»ç”¨æˆ·æœåŠ¡ä¸­è·å–ç»“æœå¹¶è¿›è¡Œä¼ è¾“ã€‚æˆ‘ä»¬ç»™ UserController æ·»åŠ ç±»ä¸€ä¸ª **Service** è£…é¥°å™¨ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªç±»ç”± IoC å®¹å™¨è¿›è¡Œç®¡ç†ã€‚åœ¨æ„é€ å‡½æ•°æ–¹æ³•å†…éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªç±»éœ€è¦ä¸€ä¸ª UserService å®ä¾‹ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ§åˆ¶è¿™ä¸ªä¾èµ–å…³ç³»ã€‚å› ä¸º TypeDI å®¹å™¨ä¸º UserService åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ï¼Œå½“å®ƒç”Ÿæˆ UserController å®ä¾‹æ—¶ï¼Œå®ƒå°†æ³¨å…¥åˆ°  UserService ä¸­ã€‚

```TypeScript
import { Service } from "typedi";
import User from "../models/User";
import UserRepository from "../repositories/UserRepository";

@Service()
class UserService {
  constructor(private readonly userRepository: UserRepository) { }
  async getAllUsers(): Promise<User[]> {
    const result = await this.userRepository.getAllUsers();
    return result;
  }
}

export default UserService;
```

UserService å’Œ UserController å¾ˆç±»ä¼¼ã€‚æˆ‘ä»¬å‘ç±»æ·»åŠ ä¸€ä¸ª Service è£…é¥°å™¨ï¼Œå¹¶åœ¨æ„é€ å‡½æ•°æ–¹æ³•ä¸­æŒ‡å®šå®ƒä»¬æƒ³è¦çš„ä¾èµ–é¡¹ã€‚

```TypeScript
import { Service } from "typedi";
import User from "../models/User";

@Service()
class UserRepository {
  private readonly users: User[] = [
    { name: 'Emily' },
    { name: 'John' },
    { name: 'Jane' },
  ];

  async getAllUsers(): Promise<User[]> {
    return this.users;
  }
}

export default UserRepository;
```

UserRepository æ˜¯æˆ‘ä»¬çš„æœ€åä¸€æ­¥ã€‚æˆ‘ä»¬ç”¨ Service æ¥æ³¨è§£è¿™ä¸ªç±»ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»ã€‚å› ä¸ºæ²¡æœ‰æ•°æ®åº“è¿æ¥ï¼Œæ‰€ä»¥æˆ‘åªæ˜¯å°†å·²ç¡¬ç¼–ç è¿‡çš„ç”¨æˆ·åˆ—è¡¨ä½œä¸ºç§æœ‰å±æ€§æ·»åŠ åˆ°ç±»ä¸­ã€‚

## ç»“è®º

ä¾èµ–æ³¨å…¥æ˜¯ç®¡ç†å¤æ‚å¯¹è±¡åˆå§‹åŒ–çš„æœ‰åŠ›å·¥å…·ã€‚æ‰‹åŠ¨è¿›è¡Œä¾èµ–æ³¨å…¥æ€»æ¯”ä»€ä¹ˆéƒ½ä¸åšè¦å¥½ï¼Œä½†æ˜¯ä½¿ç”¨ TypeDI æ›´ç®€å•å¯è¡Œã€‚å½“ä½ è¦å¼€å§‹åšä¸€ä¸ªæ–°é¡¹ç›®æ—¶ï¼Œä½ åº”è¯¥æ˜ç¡®åœ°è€ƒè™‘ä¸‹ä¾èµ–æ³¨å…¥åŸåˆ™å¹¶ç»™äºˆé€‚å½“å°è¯•ã€‚

ä½ å¯ä»¥åœ¨[è¿™ä¸ª GitHub åˆ†æ”¯](https://github.com/mertturkmenoglu/typescript-dependency-injection)æ‰¾åˆ°æœ¬æ–‡çš„ä»£ç ã€‚

ä½ å¯ä»¥åœ¨ [GitHub](https://github.com/mertturkmenoglu)ã€[LinkedIn](https://www.linkedin.com/in/mert-turkmenoglu/) å’Œ [Twitter](https://twitter.com/capreaee) æ‰¾åˆ°æˆ‘ã€‚

æ„Ÿè°¢é˜…è¯»ï¼Œç¥ä½ å¿«ä¹ã€‚

## å¼•ç”¨

* [1] [https://www.tutorialsteacher.com/ioc/dependency-injection](https://www.tutorialsteacher.com/ioc/dependency-injection)
* [2] [https://en.wikipedia.org/wiki/Dependency_injection](https://en.wikipedia.org/wiki/Dependency_injection)
* [3] [https://developer.android.com/training/dependency-injection](https://developer.android.com/training/dependency-injection)
* [4] [https://stackoverflow.com/questions/21288/which-net-dependency-injection-frameworks-are-worth-looking-into](https://stackoverflow.com/questions/21288/which-net-dependency-injection-frameworks-are-worth-looking-into)
* [5] [https://docs.typestack.community/typedi/v/develop/01-getting-started](https://docs.typestack.community/typedi/v/develop/01-getting-started)

---
 * åŸæ–‡åœ°å€ï¼š[Dependency Injection in TypeScript](https://levelup.gitconnected.com/dependency-injection-in-typescript-2f66912d143c)
 * åŸæ–‡ä½œè€…ï¼š[Mert TÃ¼rkmenoÄŸlu](https://medium.com/@mertturkmenoglu)
 * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
 * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/article/2021/dependency-injection-in-typescript.md](https://github.com/xitu/gold-miner/blob/master/article/2021/dependency-injection-in-typescript.md)
 * è¯‘è€…ï¼š[Usualminds](https://github.com/Usualminds)
 * æ ¡å¯¹è€…ï¼š[Kim Yang](https://github.com/KimYangOfCat)ã€[PassionPenguin](https://github.com/PassionPenguin)