---
title: "JavaScript ç±»å‹åŒ–æ•°ç»„"
date: 2021-05-18
tags: [JavaScript,å‰ç«¯]
categories: [ğŸŒ ç¿»è¯‘æ ¡å¯¹]
---

![å›¾æº [Pierre Bamin](https://unsplash.com/@bamin?utm_source=juejin&utm_medium=referral)ï¼Œå‡ºè‡ª [Unsplash](https://unsplash.com?utm_source=juejin&utm_medium=referral)](https://cdn-images-1.medium.com/max/10992/0*u7yLuqz5vOYfScJQ)

åœ¨ JavaScript è¿™é—¨è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬æ‰€æœ‰äººéƒ½å¿…é¡»å¯¹æ•°ç»„è¶³å¤Ÿç†Ÿæ‚‰ï¼ŒçŸ¥æ™“æ•°ç»„æœ¬è´¨ä¸Šæ˜¯åŠ¨æ€çš„ï¼Œå¹¶ä¸”å¯ä»¥å®¹çº³ä»»ä½• JavaScript å¯¹è±¡ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ æ›¾ç»ä½¿ç”¨è¿‡ç±»ä¼¼äº C è¯­è¨€è¿™æ ·çš„å…¶ä»–è¯­è¨€ï¼Œä½ åº”è¯¥çŸ¥é“å…¶æ•°ç»„æœ¬è´¨ä¸Šä¸æ˜¯åŠ¨æ€çš„ã€‚è€Œä¸”ä½ åªèƒ½åœ¨è¯¥æ•°ç»„ä¸­å­˜å‚¨ç‰¹å®šçš„æ•°æ®ç±»å‹ï¼Œæ¯•ç«Ÿä»æ€§èƒ½è§’åº¦æ¥çœ‹ï¼Œè¿™å¯ä»¥ç¡®ä¿æ•°ç»„æ•ˆç‡æ›´é«˜ã€‚ä½†æ•°ç»„çš„åŠ¨æ€åŒ–ä¸å­˜å‚¨ä¿¡æ¯ç±»å‹çš„å¤šæ ·åŒ–å…¶å®å¹¶æ²¡æœ‰ä½¿ JavaScript æ•°ç»„æ•ˆç‡ä½ä¸‹ã€‚åœ¨ JavaScript å¼•æ“ä¼˜åŒ–çš„å¸®åŠ©ä¸‹ï¼ŒJavaScript ä¸­æ•°ç»„çš„æ‰§è¡Œé€Ÿåº¦å…¶å®éå¸¸å¿«ã€‚

éšç€ Web åº”ç”¨ç¨‹åºåŠŸèƒ½è¶Šæ¥è¶Šå¼ºå¤§ï¼Œæˆ‘ä»¬å¼€å§‹éœ€è¦è®© Web åº”ç”¨ç¨‹åºå¤„ç†å’Œæ“çºµåŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚JavaScript æ•°ç»„æ— æ³•å¤„ç†è¿™äº›åŸå§‹äºŒè¿›åˆ¶æ•°æ®ï¼Œä¹Ÿå› æ­¤æˆ‘ä»¬å¼•å…¥äº† JavaScript çš„ç±»å‹åŒ–æ•°ç»„ã€‚

## ç±»å‹åŒ–æ•°ç»„

ç±»å‹åŒ–æ•°ç»„æ˜¯ä¸æ•°ç»„éå¸¸ç›¸ä¼¼çš„å¯¹è±¡ï¼Œä½†æ˜¯å®ƒæä¾›äº†ä¸€ç§å°†åŸå§‹äºŒè¿›åˆ¶æ•°æ®å†™å…¥å†…å­˜ç¼“å†²åŒºçš„æœºåˆ¶ã€‚æ‰€æœ‰ä¸»è¦æµè§ˆå™¨å‡å¾ˆå¥½åœ°æ”¯æŒæ­¤åŠŸèƒ½ï¼Œå¹¶ä¸” ES6 å·²å°†å…¶é›†æˆåˆ° JavaScript æ ¸å¿ƒæ¡†æ¶ä¸­ï¼Œä¹Ÿå¯ä»¥è®¿é—®è¯¸å¦‚ `map()`ã€`filter()` ç­‰ Array æ–¹æ³•ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ æµè§ˆæœ¬æ–‡ç»“å°¾å¤„æåˆ°çš„èµ„æºï¼Œä»¥æ›´æ·±å…¥äº†è§£ç±»å‹åŒ–æ•°ç»„ã€‚

### ç»„æˆ

ç±»å‹åŒ–æ•°ç»„ç”±ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼Œ`Buffer` å’Œ `View`ã€‚

#### ç¼“å†²åŒº

`Buffer` æ˜¯ `ArrayBuffer` ç±»å‹çš„å¯¹è±¡ï¼Œè¡¨ç¤ºä¸€ä¸ªæ•°æ®å—ã€‚æ­¤åŸå§‹äºŒè¿›åˆ¶æ•°æ®å—æ— æ³•è¢«å•ç‹¬è®¿é—®æˆ–ä¿®æ”¹ã€‚ä½ å¯èƒ½å¥½å¥‡ï¼Œæ— æ³•è®¿é—®æˆ–ä¿®æ”¹çš„æ•°æ®å¯¹è±¡çš„èƒ½æœ‰ä»€ä¹ˆç”¨é€”ã€‚å®é™…ä¸Šè§†å›¾æ˜¯ç¼“å†²åŒºçš„è¯»å†™æ¥å£ã€‚

#### è§†å›¾

`View` æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…è®¸ä½ è®¿é—®å’Œä¿®æ”¹å­˜å‚¨åœ¨ `ArrayBuffer` ä¸­çš„åŸå§‹äºŒè¿›åˆ¶å†…å®¹ã€‚ä¸€èˆ¬æ¥è¯´æœ‰ä¸¤ç§è§†å›¾ã€‚

#### `TypedArray` å¯¹è±¡çš„å®ä¾‹

è¿™äº›ç±»å‹çš„å¯¹è±¡ä¸æ™®é€šæ•°ç»„éå¸¸ç›¸ä¼¼ï¼Œä½†æ˜¯ä»…å­˜å‚¨å•ä¸€ç±»å‹çš„æ•°å€¼æ•°æ®ã€‚è¯¸å¦‚ `Int8`ã€`Uint8`ã€`Int16`ã€`Float32` å°±æ˜¯ç±»å‹åŒ–æ•°ç»„çš„æ•°æ®ç±»å‹ã€‚ç±»å‹ä¸­çš„æ•°å­—è¡¨ç¤ºä¸ºæ•°æ®ç±»å‹åˆ†é…çš„ä½æ•°ã€‚ä¾‹å¦‚ï¼Œ`Int8` è¡¨ç¤º 8 ä½çš„æ•´æ•°ã€‚

> ä½ å¯ä»¥é˜…è¯» [å‚è€ƒæ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Typed_arrays#%E7%B1%BB%E5%9E%8B%E6%95%B0%E7%BB%84%E8%A7%86%E5%9B%BE) æ¥è¯¦ç»†äº†è§£ç±»å‹åŒ–æ•°ç»„çš„æ•°æ®ç±»å‹ã€‚

#### `DataView` å¯¹è±¡çš„å®ä¾‹

`DataView` æ˜¯ä¸€ä¸ªä½çº§æ¥å£ï¼Œæä¾›äº†ä¸€ä¸ª `getter` / `setter` API æ¥è¯»å–å’Œå†™å…¥ä»»æ„æ•°æ®åˆ°ç¼“å†²åŒºã€‚è¿™å¾ˆå¤§ç¨‹åº¦ä¸Šæ–¹ä¾¿äº†æˆ‘ä»¬çš„å¼€å‘ï¼Œå°¤å…¶æ˜¯éœ€è¦åœ¨å•ä¸ªç±»å‹åŒ–æ•°ç»„ä¸­å¤„ç†å¤šç§æ•°æ®ç±»å‹æ—¶ã€‚

ä½¿ç”¨ `DataView` çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå®ƒå¯ä»¥è®©ä½ æ§åˆ¶æ•°æ®çš„å­—èŠ‚åº â€”â€” ç±»å‹åŒ–æ•°ç»„ä½¿ç”¨å¹³å°çš„å­—èŠ‚åºã€‚å½“ç„¶å¦‚æœä½ çš„ç¨‹åºè¿è¡Œåœ¨æœ¬åœ°ï¼Œè¿™å°†ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºä½ çš„è®¾å¤‡å°†ä½¿ç”¨ä¸è¾“å…¥æ•°ç»„ç›¸åŒçš„å­—èŠ‚åºã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ çš„ç±»å‹åŒ–æ•°ç»„å°†ä¸ºä½ç«¯å­—èŠ‚åºï¼Œå› ä¸ºè‹±ç‰¹å°”é‡‡å–çš„æ˜¯å°ç«¯å­—èŠ‚åºã€‚ç”±äºè‹±ç‰¹å°”åœ¨è®¡ç®—æœºå¤„ç†å™¨ä¸­éå¸¸æ™®éï¼Œå› æ­¤å¤§å¤šæ•°æ—¶å€™ä¸ä¼šå‡ºç°é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†å°ç«¯å­—èŠ‚åºç¼–ç çš„æ•°æ®ä¼ è¾“åˆ°ä½¿ç”¨å¤§ç«¯å­—èŠ‚åºç¼–ç çš„è®¾å¤‡ï¼Œåˆ™ä¼šå¯¼è‡´è¯»å–æ—¶å€™çš„é”™è¯¯ï¼Œæœ€ç»ˆå¯èƒ½å¯¼è‡´æ•°æ®çš„ä¸¢å¤±ã€‚ç”±äº `DataView` ä½¿ä½ å¯ä»¥æ§åˆ¶å­—èŠ‚åºçš„æ–¹å‘ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨å¿…è¦æ—¶ä½¿ç”¨å®ƒã€‚

## æ˜¯ä»€ä¹ˆä½¿å®ƒä»¬ä¸æ™®é€šæ•°ç»„ä¸åŒ

å¦‚å‰æ‰€è¿°ï¼Œæ™®é€šçš„ JavaScript æ•°ç»„å·²é€šè¿‡ JavaScript å¼•æ“è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½ æ²¡å¿…è¦ä¸ºäº†æå‡æ€§èƒ½è€Œä½¿ç”¨ç±»å‹åŒ–æ•°ç»„ï¼Œå› ä¸ºè¿™ä¸ä¼šç»™ä½ å¸¦æ¥å¤ªå¤šå‡çº§ã€‚ä½†æ˜¯æœ‰äº›ç‰¹æ€§ä½¿ç±»å‹åŒ–æ•°ç»„ä¸åŒäºæ™®é€šæ•°ç»„ï¼Œè¿™æ‰å¯èƒ½æ˜¯ä½ é€‰æ‹©å®ƒä»¬çš„åŸå› ã€‚

* è®©ä½ èƒ½å¤Ÿå¤„ç†åŸå§‹äºŒè¿›åˆ¶æ•°æ®
* ç”±äºå®ƒä»¬å¤„ç†çš„æ•°æ®ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå› æ­¤ä¸æ™®é€šæ•°ç»„ç›¸æ¯”ï¼Œä½ çš„å¼•æ“æ›´æ˜“ä¼˜åŒ–ç±»å‹åŒ–æ•°ç»„ï¼Œå› ä¸ºæ™®é€šæ•°ç»„çš„ä¼˜åŒ–å…¶å®æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„è¿‡ç¨‹ã€‚
* ä¸èƒ½ä¿è¯æ™®é€šæ•°ç»„æ°¸è¿œéƒ½èƒ½å¾—åˆ°ä¼˜åŒ–ï¼Œå› ä¸ºä½ çš„å¼•æ“å¯èƒ½å› å„ç§åŸå› å†³å®šä¸è¿›è¡Œä¼˜åŒ–ã€‚

## åœ¨ Web å¼€å‘ä¸­çš„ç”¨é€”

### XMLHttpRequest API

ä½ å¯ä»¥æ ¹æ®ä½ çš„å“åº”ç±»å‹ä»¥ `ArrayBuffer` å½¢å¼æ¥æ”¶æ•°æ®å“åº”ã€‚

```js
const xhr = new XMLHttpRequest();
xhr.open('GET', exampleUrl);
xhr.responseType = 'arraybuffer';

xhr.onload = function () {
    const arrayBuffer = xhr.response;
    // å¤„ç†æ•°æ®
};

xhr.send();
```

### Fetch API

ç±»ä¼¼äº XMLHttpRequest APIï¼ŒFetch API è¿˜å…è®¸ä½ åœ¨ `ArrayBuffer` ä¸­æ¥æ”¶å“åº”ã€‚ä½ åªéœ€åœ¨ fetch API å“åº”ä¸­ä½¿ç”¨ `arrayBuffer()` æ–¹æ³•ï¼Œä½ å°±èƒ½å¤Ÿæ”¶åˆ°ä¸€ä¸ªä½¿ç”¨ `ArrayBuffer` è§£æçš„ `Promise`ã€‚

```js
fetch(url)
.then(response => response.arrayBuffer())
.then(arrayBuffer => {
   // å¤„ç†æ•°æ®
});
```

### HTML Canvas

HTML5 Canvas å…ƒç´ ä½¿ä½ å¯ä»¥æ¸²æŸ“åŠ¨æ€çš„ 2D å½¢çŠ¶å’Œä½å›¾å›¾åƒã€‚è¯¥å…ƒç´ ä»…å……å½“å›¾å½¢çš„å®¹å™¨ï¼Œè€Œå›¾å½¢åˆ™æ˜¯åœ¨ JavaScript çš„å¸®åŠ©ä¸‹ç»˜åˆ¶ã€‚

canvas çš„ 2D Context ä½¿ä½ å¯ä»¥å°†ä½å›¾æ•°æ®ä½œä¸º `Uint8ClampedArray` çš„å®ä¾‹è¿›è¡Œæ£€ç´¢ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ Axel åšå£«æä¾›çš„ç¤ºä¾‹ä»£ç ï¼š

```js
const canvas = document.getElementById('my_canvas');
const context = canvas.getContext('2d');
const imageData = context.getImageData(0, 0, canvas.width, canvas.height);
const uint8ClampedArray = imageData.data;
```

### WebGL

WebGL å…è®¸ä½ æ¸²æŸ“é«˜æ€§èƒ½çš„äº¤äº’å¼ 3D å’Œ 2D å›¾å½¢ã€‚å®ƒåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºç±»å‹åŒ–æ•°ç»„ï¼Œå› ä¸ºå®ƒä¼šå¤„ç†åŸå§‹åƒç´ æ•°æ®ä»¥åœ¨ç”»å¸ƒä¸Šè¾“å‡ºå¿…è¦çš„å›¾å½¢ã€‚

ä½ å¯ä»¥åœ¨ [è¿™ç¯‡æ–‡ç« ](https://blog.bitsrc.io/understanding-webgl-51ab81ccb48c) ä¸­é˜…è¯»æœ‰å…³ WebGL åŸºç¡€çš„æ›´å¤šä¿¡æ¯ã€‚

### Web Socket

Web Socket å…è®¸ä½ ä»¥ Blob æˆ–æ•°ç»„ç¼“å†²åŒºçš„å½¢å¼å‘é€å’Œæ¥æ”¶åŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚

```js
const socket = new WebSocket("ws://localhost:8080");
socket.binaryType = "arraybuffer";

// ç›‘å¬ message
socket.addEventListener("message", function (event) {
    const view = new DataView(event.data);
    // å¤„ç†æ¥æ”¶æ•°æ®
});

// å‘é€äºŒè¿›åˆ¶æ•°æ®
socket.addEventListener('open', function (event) {
    const typedArray = new Uint16Array(7);
    socket.send(typedArray.buffer);
});
```

å°½ç®¡åˆå­¦è€…å¯èƒ½ä¸éœ€è¦è¯¦ç»†äº†è§£ç±»å‹åŒ–æ•°ç»„ï¼Œä½†æ˜¯å½“ä½ è¿›å…¥ä¸­é«˜çº§ JavaScript å¼€å‘çš„æ—¶å€™ï¼Œå®ƒä»¬æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºä½ å¯èƒ½è¦å¼€å‘éœ€è¦ä½¿ç”¨ç±»å‹åŒ–æ•°ç»„çš„æ›´å¤æ‚çš„åº”ç”¨ç¨‹åºã€‚

è¦æ·±å…¥äº†è§£ç±»å‹åŒ–æ•°ç»„ï¼Œè¯·æµè§ˆä¸‹é¢é™„å¸¦çš„èµ„æºé“¾æ¥ã€‚

æ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œç¥ä½ ç¼–ç¨‹æ„‰å¿«ï¼ï¼

## èµ„æº

* [JavaScript ç±»å‹åŒ–æ•°ç»„ - MDN æ–‡æ¡£](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Typed_arrays)
* [Exploring JS by Dr. Axel](https://exploringjs.com/es6/ch_typed-arrays.html)

> * åŸæ–‡åœ°å€ï¼š[JavaScript Typed Arrays](https://blog.bitsrc.io/javascript-typed-arrays-ccfa5ae8838d)
> * åŸæ–‡ä½œè€…ï¼š[Mahdhi Rezvi](https://medium.com/@mahdhirezvi)
> * è¯‘æ–‡å‡ºè‡ªï¼š[æ˜é‡‘ç¿»è¯‘è®¡åˆ’](https://github.com/xitu/gold-miner)
> * æœ¬æ–‡æ°¸ä¹…é“¾æ¥ï¼š[https://github.com/xitu/gold-miner/blob/master/article/2021/javascript-typed-arrays.md](https://github.com/xitu/gold-miner/blob/master/article/2021/javascript-typed-arrays.md)
> * è¯‘è€…ï¼š[éœœç¾½ Hoarfroster](https://github.com/PassionPenguin)
> * æ ¡å¯¹è€…ï¼š[Kim Yang](https://github.com/KimYangOfCat)ã€[Kimhooo](https://github.com/Kimhooo)