(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{648:function(t,e,s){"use strict";s.r(e);var a=s(6),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("Web 平台上的“自定义”功能越来越多，比如自定义属性（"),s("code",[t._v("--my-property")]),t._v("）、自定义元素（"),s("code",[t._v("<my-element>")]),t._v("）和自定义事件（"),s("code",[t._v("new CustomEvent('myEvent')")]),t._v("）。我们一度甚至还能使用"),s("a",{attrs:{href:"https://css-tricks.com/platform-news-defaulting-to-logical-css-fugu-apis-custom-media-queries-and-wordpress-vs-italics/#still-no-progress-on-css-custom-media-queries",target:"_blank",rel:"noopener noreferrer"}},[t._v("自定义媒体查询"),s("OutboundLink")],1),t._v(" ("),s("code",[t._v("@media (--my-media)")]),t._v(")。")]),t._v(" "),s("p",[t._v("但那还没完！有个新的“自定义”功能你可能错过了，"),t._v("因为这篇 Google 发布的 "),s("a",{attrs:{href:"https://developer.chrome.com/blog/new-in-chrome-90/",target:"_blank",rel:"noopener noreferrer"}},[t._v("“New in Chrome 90”"),s("OutboundLink")],1),t._v(" 文章中并没有提到（公平地说，"),s("a",{attrs:{href:"https://css-tricks.com/platform-news-using-focus-visible-bbcs-new-typeface-declarative-shadow-doms-a11y-and-placeholders/#declarative-shadow-dom-could-help-popularize-style-encapsulation",target:"_blank",rel:"noopener noreferrer"}},[t._v("声明性（declarative） shadow DOM"),s("OutboundLink")],1),t._v(" 在这次发布中占尽了风头），但是 Chrome 刚刚增加了对另一个“自定义”功能的支持：自定义状态伪类（"),s("code",[t._v(":--my-state")]),t._v("）。")]),t._v(" "),s("h2",{attrs:{id:"内置状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内置状态"}},[t._v("#")]),t._v(" 内置状态")]),t._v(" "),s("p",[t._v("在讨论自定义状态之前，我们先快速查看下内置 HTML 元素定义的内置状态。HTML 标准的 "),s("a",{attrs:{href:"https://drafts.csswg.org/selectors/",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSS 选择器模块"),s("OutboundLink")],1),t._v("和"),s("a",{attrs:{href:"https://html.spec.whatwg.org/multipage/semantics-other.html#pseudo-classes",target:"_blank",rel:"noopener noreferrer"}},[t._v("“伪类”章节"),s("OutboundLink")],1),t._v("指定了许多可以用于匹配不同状态元素的伪类。下面提到的所有伪类都在当今的浏览器中得到了广泛的支持：")]),t._v(" "),s("h3",{attrs:{id:"用户操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用户操作"}},[t._v("#")]),t._v(" 用户操作")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v(":hover")])]),t._v(" "),s("td",[t._v("鼠标光标悬停在元素上")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":active")])]),t._v(" "),s("td",[t._v("该元素被用户激活")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":focus")])]),t._v(" "),s("td",[t._v("该元素获得焦点")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":focus-within")])]),t._v(" "),s("td",[t._v("该元素或者后代元素获得焦点")])])])]),t._v(" "),s("h3",{attrs:{id:"定位"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#定位"}},[t._v("#")]),t._v(" 定位")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v(":visited")])]),t._v(" "),s("td",[t._v("该链接之前被用户访问过")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":target")])]),t._v(" "),s("td",[t._v("该元素被页面的 URL 片段指定")])])])]),t._v(" "),s("h3",{attrs:{id:"输入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#输入"}},[t._v("#")]),t._v(" 输入")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v(":disabled")])]),t._v(" "),s("td",[t._v("表单元素被禁用")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":placeholder-shown")])]),t._v(" "),s("td",[t._v("input 元素正在展示 placeholder 文本")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":checked")])]),t._v(" "),s("td",[t._v("复选框或单选按钮被选中")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":invalid")])]),t._v(" "),s("td",[t._v("表单元素的值不合法")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":out-of-range")])]),t._v(" "),s("td",[t._v("input 元素的值"),s("a",{attrs:{href:"https://twitter.com/mgechev/status/1384726124522098688",target:"_blank",rel:"noopener noreferrer"}},[t._v("超出指定范围"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("code",[t._v(":-webkit-autofill")])]),t._v(" "),s("td",[t._v("input 元素的值被浏览器自动填充")])])])]),t._v(" "),s("h3",{attrs:{id:"其他状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他状态"}},[t._v("#")]),t._v(" 其他状态")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v(":defined")])]),t._v(" "),s("td",[t._v("该自定义元素已被注册")])])])]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("注：")]),t._v(" 为简洁起见，有些伪类被省略了，并且有些伪类的描述没有包括所有可能的用例。")])]),t._v(" "),s("h2",{attrs:{id:"自定义状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义状态"}},[t._v("#")]),t._v(" 自定义状态")]),t._v(" "),s("p",[t._v("与内置元素类似，自定义元素也可以有不同的状态。使用自定义元素的网页可能想给这些状态设置不同的样式。自定义元素可以通过它的宿主元素的 CSS 类（"),s("code",[t._v("class")]),t._v(" 属性）来暴露状态，但"),s("a",{attrs:{href:"https://github.com/WICG/webcomponents/issues/738#issuecomment-367499244",target:"_blank",rel:"noopener noreferrer"}},[t._v("这被认为是一种反模式"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("p",[t._v("Chrome 现在支持将内部状态添加到自定义元素的 API。这些状态通过自定义状态伪类暴露出来。例如：使用 "),s("code",[t._v("<live-score>")]),t._v(" 元素的页面可以给这个元素自定义的 "),s("code",[t._v("--loading")]),t._v(" 状态声明样式。")]),t._v(" "),s("div",{staticClass:"language-css extra-class"},[s("pre",{pre:!0,attrs:{class:"language-css"}},[s("code",[s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("live-score")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 元素的默认样式 */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("live-score:--loading")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 新内容加载时的样式 */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"让我们给-labeled-checkbox-元素添加-checked-状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#让我们给-labeled-checkbox-元素添加-checked-状态"}},[t._v("#")]),t._v(" 让我们给 "),s("code",[t._v("<labeled-checkbox>")]),t._v(" 元素添加 "),s("code",[t._v("--checked")]),t._v(" 状态")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://wicg.github.io/custom-state-pseudo-class/",target:"_blank",rel:"noopener noreferrer"}},[t._v("自定义状态伪类"),s("OutboundLink")],1),t._v("规范包含一个完整的代码示例。我将用这个示例解释 API。此功能的 JavaScript 部分位于自定义元素的类定义中。在构造函数中，为自定义元素创建“"),s("a",{attrs:{href:"https://html.spec.whatwg.org/multipage/custom-elements.html#element-internals",target:"_blank",rel:"noopener noreferrer"}},[t._v("元素内部"),s("OutboundLink")],1),t._v("”对象，之后可以在 "),s("code",[t._v("states")]),t._v(" 内部对象上设置或取消设置自定义状态。")]),t._v(" "),s("p",[t._v("请注意 "),s("a",{attrs:{href:"https://html.spec.whatwg.org/multipage/custom-elements.html#element-internals",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("ElementInternals")]),s("OutboundLink")],1),t._v(" API 可确保自定义状态在元素外部"),s("a",{attrs:{href:"https://github.com/w3ctag/design-reviews/issues/428#issuecomment-566103510",target:"_blank",rel:"noopener noreferrer"}},[t._v("只读"),s("OutboundLink")],1),t._v("。换句话说，元素外部不能修改自定义元素的内部状态。")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LabeledCheckbox")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HTMLElement")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 创建“元素内部”对象")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_internals "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("attachInternals")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// （其他代码）")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 设置自定义状态")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checked")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("flag")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("flag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_internals"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("states"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--checked"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_internals"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("states"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"--checked"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// （其他代码）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("网页现在可以通过同名的自定义伪类来给自定义元素的内部状态设置样式。在我们的例子中，"),s("code",[t._v("--checked")]),t._v(" 状态以 "),s("code",[t._v(":--checked")]),t._v(" 伪类的形式暴露出来。")]),t._v(" "),s("div",{staticClass:"language-css extra-class"},[s("pre",{pre:!0,attrs:{class:"language-css"}},[s("code",[s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("labeled-checkbox")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 默认状态下的样式 */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("labeled-checkbox:--checked")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* --checked 状态下的样式 */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("img",{attrs:{src:"https://picbed.kimyang.cn/202109050836870.gif",alt:""}})]),t._v(" "),s("p",[s("a",{attrs:{href:"https://codepen.io/simevidas/pen/ZELwEBy",target:"_blank",rel:"noopener noreferrer"}},[t._v("用 Chrome 浏览器打开这个 demo"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"此功能尚未成为标准"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#此功能尚未成为标准"}},[t._v("#")]),t._v(" 此功能尚未成为标准")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/WICG/webcomponents/issues/738",target:"_blank",rel:"noopener noreferrer"}},[t._v("过去三年来"),s("OutboundLink")],1),t._v("，浏览器厂商一直在讨论如何通过自定义伪类来暴露自定义元素的内部状态。Google 的"),s("a",{attrs:{href:"https://wicg.github.io/custom-state-pseudo-class/",target:"_blank",rel:"noopener noreferrer"}},[t._v("自定义状态伪类"),s("OutboundLink")],1),t._v("规范目前托管在 WICG 名下，仍然处于一个非官方的状态。该功能由 W3C 技术架构组（TAG）"),s("a",{attrs:{href:"https://github.com/w3ctag/design-reviews/issues/428",target:"_blank",rel:"noopener noreferrer"}},[t._v("进行设计审查"),s("OutboundLink")],1),t._v("并"),s("a",{attrs:{href:"https://github.com/w3c/csswg-drafts/issues/4805",target:"_blank",rel:"noopener noreferrer"}},[t._v("移交给 CSS 工作组"),s("OutboundLink")],1),t._v("。在 Chrome 的“出货意向”讨论中，"),s("a",{attrs:{href:"https://groups.google.com/a/chromium.org/g/blink-dev/c/dJibhmzE73o/m/VT-NceIhAAAJ",target:"_blank",rel:"noopener noreferrer"}},[t._v("Mounir Lamouri 写道"),s("OutboundLink")],1),t._v("：")]),t._v(" "),s("hr"),t._v(" "),s("ul",[s("li",[t._v("原文地址："),s("a",{attrs:{href:"https://css-tricks.com/custom-state-pseudo-classes-in-chrome/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Custom State Pseudo-Classes in Chrome"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("原文作者："),s("a",{attrs:{href:"https://css-tricks.com/author/simevidas/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Šime Vidas"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("译文出自："),s("a",{attrs:{href:"https://github.com/xitu/gold-miner",target:"_blank",rel:"noopener noreferrer"}},[t._v("掘金翻译计划"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("本文永久链接："),s("a",{attrs:{href:"https://github.com/xitu/gold-miner/blob/master/article/2021/custom-state-pseudo-classes-in-chrome.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/xitu/gold-miner/blob/master/article/2021/custom-state-pseudo-classes-in-chrome.md"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("译者："),s("a",{attrs:{href:"https://github.com/iceytea",target:"_blank",rel:"noopener noreferrer"}},[t._v("iceytea"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("校对者："),s("a",{attrs:{href:"https://github.com/darkyzhou",target:"_blank",rel:"noopener noreferrer"}},[t._v("darkyzhou"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://github.com/Chorer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chor"),s("OutboundLink")],1),t._v("、"),s("a",{attrs:{href:"https://github.com/KimYangOfCat",target:"_blank",rel:"noopener noreferrer"}},[t._v("Kim Yang"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=r.exports}}]);